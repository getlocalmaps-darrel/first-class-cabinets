---
// src/pages/contact.astro
import MainLayout from '../layouts/MainLayout.astro';

const pageTitle = "Contact First Class Woodworks | Murrieta Custom Cabinets";
const pageDescription = "Get a quote for custom kitchen cabinets, bathroom vanities, or built-ins in Murrieta and Temecula. Contact us today.";
---

<MainLayout title={pageTitle} description={pageDescription}>

  <section class="bg-zinc-900 text-white pt-48 pb-20 relative overflow-hidden">
    <div class="absolute inset-0 bg-black/40 z-0"></div>
    <div class="relative z-10 max-w-7xl mx-auto px-6 text-center">
      <h1 class="text-4xl md:text-5xl font-serif font-bold mb-4">Start Your Project</h1>
      <div class="h-1 w-20 bg-yellow-600 mx-auto rounded-full mb-6"></div>
      <p class="text-xl text-zinc-300 max-w-2xl mx-auto font-light">
        We are currently accepting new custom cabinetry projects in Murrieta and the Temecula Valley.
      </p>
    </div>
  </section>

  <section class="py-20 bg-zinc-50">
    <div class="max-w-7xl mx-auto px-6">
      
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-16">
        
        <div class="reveal">
          <h2 class="text-3xl font-serif font-bold text-zinc-900 mb-6">Contact Information</h2>
          <p class="text-zinc-600 mb-10 leading-relaxed">
            Please fill out the form to request a design consultation or quote. 
            Because we are often in the shop milling or on-site installing, 
            using this form is the fastest way to get your project into our queue.
          </p>

          <div class="space-y-8">
            <div class="flex items-start gap-4">
              <div class="bg-white p-3 shadow-md border border-zinc-100 rounded-sm text-yellow-600">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z" />
                </svg>
              </div>
              <div>
                <h3 class="font-bold text-zinc-900 uppercase tracking-wide text-sm">Phone</h3>
                <a href="tel:9519731265" class="text-zinc-600 hover:text-yellow-600 transition">951-973-1265</a>
              </div>
            </div>

            <div class="flex items-start gap-4">
              <div class="bg-white p-3 shadow-md border border-zinc-100 rounded-sm text-yellow-600">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" />
                </svg>
              </div>
              <div>
                <h3 class="font-bold text-zinc-900 uppercase tracking-wide text-sm">Service Area</h3>
                <p class="text-zinc-600">Murrieta, Temecula, Winchester, Menifee & Wildomar</p>
              </div>
            </div>
            
            <div class="bg-zinc-100 p-6 border-l-4 border-yellow-600 mt-8">
              <p class="text-xs font-bold text-zinc-500 uppercase tracking-widest mb-2">Note on Timelines</p>
              <p class="text-zinc-700 text-sm italic">
                We are a custom finish carpentry team, not a general handyman service. Lead times for full kitchen builds are typically 6-10 weeks.
              </p>
            </div>
          </div>
        </div>

        <div class="bg-white p-8 md:p-10 shadow-2xl border-t-4 border-yellow-600 reveal delay-200 rounded-sm relative min-h-[500px]">
          
          <div id="form-container">
            <h3 class="text-2xl font-serif font-bold mb-8">Request a Quote</h3>
            
            <form id="contactForm" action="https://api.web3forms.com/submit" method="POST">
              
              <input type="hidden" name="access_key" value="a15ff6b3-86ad-4811-9818-d2cf6cfb6e9a">
              
              <div class="hidden" style="display:none;">
                <input type="checkbox" name="botcheck" class="hidden" style="display: none;">
              </div>
              
              <input type="hidden" name="to" value="firstclasswoodworks@hotmail.com">
              <input type="hidden" name="cc" value="getlocalmaps@gmail.com,9519731265@t-mobile.net">
              <input type="hidden" name="subject" value="First Class WoodWorks Lead">
              
              <div class="space-y-6">
                <div>
                  <label for="name" class="block text-xs font-bold uppercase tracking-wider text-zinc-500 mb-2">Full Name</label>
                  <input type="text" id="name" name="name" required class="w-full bg-zinc-50 border border-zinc-200 p-3 outline-none focus:border-yellow-600 focus:ring-1 focus:ring-yellow-600 transition duration-300" placeholder="John Doe">
                </div>

                <div>
                  <label for="email" class="block text-xs font-bold uppercase tracking-wider text-zinc-500 mb-2">Email Address</label>
                  <input type="email" id="email" name="email" required class="w-full bg-zinc-50 border border-zinc-200 p-3 outline-none focus:border-yellow-600 focus:ring-1 focus:ring-yellow-600 transition duration-300" placeholder="john@example.com">
                </div>

                <div class="relative">
                  <label for="phone" class="block text-xs font-bold uppercase tracking-wider text-zinc-500 mb-2">Phone Number</label>
                  <input type="tel" id="phone" name="phone" required class="w-full bg-zinc-50 border border-zinc-200 p-3 outline-none focus:border-yellow-600 focus:ring-1 focus:ring-yellow-600 transition duration-300" placeholder="888-888-8888">
                  <div id="phone-warning" class="hidden absolute -bottom-6 left-0 text-[10px] font-bold text-zinc-400 bg-zinc-100 px-2 py-1 rounded border border-zinc-200">
                    Format Required: 888-888-8888
                  </div>
                </div>

                <div>
                  <label for="message" class="block text-xs font-bold uppercase tracking-wider text-zinc-500 mb-2">Project Details</label>
                  <textarea id="message" name="message" rows="4" required class="w-full bg-zinc-50 border border-zinc-200 p-3 outline-none focus:border-yellow-600 focus:ring-1 focus:ring-yellow-600 transition duration-300" placeholder="Tell us about your project..."></textarea>
                  <p class="text-[10px] text-zinc-400 mt-2">* For security, messages containing website links (URLs) will not be sent.</p>
                </div>

                <button type="submit" id="submitBtn" class="w-full bg-zinc-900 text-white font-bold uppercase tracking-widest py-4 hover:bg-yellow-600 transition duration-300">
                  Send Message
                </button>
              </div>
            </form>
          </div>

          <div id="thank-you" class="hidden absolute inset-0 flex flex-col items-center justify-center p-10 text-center">
             <div class="bg-yellow-600 p-4 rounded-full text-white mb-6">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-12 h-12">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" />
                </svg>
             </div>
             <h3 class="text-3xl font-serif font-bold text-zinc-900 mb-4">Message Sent!</h3>
             <p class="text-zinc-600 leading-relaxed">
                Thank you for reaching out. We've received your project details and your client will receive a text message shortly. We'll be in touch soon!
             </p>
          </div>

        </div>

      </div>
    </div>
  </section>

</MainLayout>

<script>
  const form = document.getElementById('contactForm') as HTMLFormElement;
  const formContainer = document.getElementById('form-container');
  const thankYou = document.getElementById('thank-you');
  const submitBtn = document.getElementById('submitBtn') as HTMLButtonElement;
  
  const phoneInput = document.getElementById('phone') as HTMLInputElement;
  const phoneWarning = document.getElementById('phone-warning');
  const messageInput = document.getElementById('message') as HTMLTextAreaElement;

  // Phone Validation
  phoneInput.addEventListener('input', () => {
    const phoneRegex = /^\d{3}-\d{3}-\d{4}$/;
    if (phoneInput.value.length > 0 && !phoneRegex.test(phoneInput.value)) {
      phoneWarning.classList.remove('hidden');
      phoneInput.classList.add('border-red-300');
    } else {
      phoneWarning.classList.add('hidden');
      phoneInput.classList.remove('border-red-300');
    }
  });

  // AJAX Submission Logic
  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    // 1. Validate Phone
    const phoneRegex = /^\d{3}-\d{3}-\d{4}$/;
    if (!phoneRegex.test(phoneInput.value)) {
      alert('Please use the phone format: 888-888-8888');
      return;
    }

    // 2. Validate Message for Links
    const urlRegex = /(https?:\/\/|www\.|[\w-]+\.(com|net|org|info|biz|xyz))/i;
    if (urlRegex.test(messageInput.value)) {
      alert('Links are not allowed in the message.');
      return;
    }

    // 3. Prepare Submission
    submitBtn.innerText = "Sending...";
    submitBtn.disabled = true;
    
    const formData = new FormData(form);
    const object = Object.fromEntries(formData);
    const json = JSON.stringify(object);

    try {
      const response = await fetch('https://api.web3forms.com/submit', {
          method: 'POST',
          headers: {
              'Content-Type': 'application/json',
              'Accept': 'application/json'
          },
          body: json
      });

      if (response.status === 200) {
          // 4. Success Animation
          formContainer.classList.add('hidden');
          thankYou.classList.remove('hidden');
      } else {
          console.log(response);
          alert("Something went wrong. Please call us directly.");
          submitBtn.innerText = "Send Message";
          submitBtn.disabled = false;
      }
    } catch (error) {
      console.log(error);
      alert("Something went wrong. Please check your internet connection.");
      submitBtn.innerText = "Send Message";
      submitBtn.disabled = false;
    }
  });

  // Reveal Animation
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) entry.target.classList.add('active');
    });
  }, { threshold: 0.1 });
  document.querySelectorAll('.reveal').forEach((el) => observer.observe(el));
</script>

<style>
  .reveal {
    opacity: 0;
    transform: translateY(30px);
    transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1);
  }
  .reveal.active {
    opacity: 1;
    transform: translateY(0);
  }
</style>